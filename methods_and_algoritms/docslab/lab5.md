# Лабораторна робота № 5

## Тема: Наближене диференціювання

### Теоретичні відомості

#### 1. Постановка задачі наближеного диференціювання

Чисельним диференціюванням користуються для відшукання похідної функції, а також для наближеного обчислення похідної аналітично заданої функції, безпосереднє диференціювати яку тяжко.

Для відшукання похідної функції y=f(x) здійснюють інтерполювання функції на розглядуваному відрізку [a;b] многочленом Pn(x) і його похідну приймають за похідну функції, тобто покладають

f'(x)=Pn'(x), a≤x≤b (1).

Аналогічно можна поступати і при знаходженні похідних вищих порядків, хоча для похідних порядку вище другого таку процедуру зазвичай не застосовують. Це зв'язано з тим, що похибка наближеної формули (1) мало зв'язана з похибкою інтерполювання. Дійсно, геометрично очевидно, що якщо ординати f(x₁) i Pn(x) кривих y=f(x) i y=Pn(x) в точці x₁ мало відрізняються одна від другої, то це не веде за собою незначної відмінності їх похідних f'(x₁) i Pn'(x₁) – кутових коефіцієнтів дотичних до цих кривих. З зростанням порядку похідної точність чисельного диференціювання різко падає.

#### 2. Наближене диференціювання за допомогою інтерполяційного многочлена Ньютона

Для знаходження похідної f'(x) функції f(x), заданої таблицею з рівномірно розподіленими вузлами, використаємо многочлен Ньютона, представлений першою формулою, якщо х ближче до х₀, чи другою, якщо х ближче до хₙ. Тоді із:

Pn(x) = Pn(x₀+th) = y₀ + (Δy₀/1!) * t + (Δ²y₀/2!) * t(t-1) + ... + (Δᵏy₀/k!) * t(t-1)...(t-(k-1)) + ... + ... =

= y₀ + Σ(k=1 до n) (Δᵏy₀/k!) * t(t-1)...(t-(k-1)),

враховуючи t = (x-x₀)/h, одержимо

Pn'(x) = (Pn(x₀+th))'x = (Pn')'t * t'x = (1/h) * (Δy₀ + (2t-1)(Δ²y₀/2!) + (3t²-6t+2)*(Δ³y₀/3!) + ...),

Pn"(x) = (Pn'(x₀+th))'x = (Pn')'t * t'x = (1/h²) * (Δ²y₀ + (t-1)Δ³y₀ + ...).

Аналогічно із:

Pn(x) = Pn(xₙ+th) = yₙ + (Δyₙ₋₁/1!) * t + (Δ²yₙ₋₂/2!) * t(t+1) + ... + (Δᵏyₙ₋ₖ/k!) * t(t+1)...(t+(k-1)) + ... + ... =

= yₙ + Σ(k=1 до n) (Δᵏyₙ₋ₖ/k!) * t(t+1)...(t+(k-1)),

враховуючи t = (x-xₙ)/h, одержимо

Pn'(x) = (Pn(xₙ+th))'x = (Pn')'t * t'x = (1/h) * (Δyₙ₋₁ + (2t+1)(Δ²yₙ₋₂/2!) + (3t²+6t+2)*(Δ³yₙ₋₃/3!) + ...),

Pn"(x) = (Pn'(xₙ+th))'x = (Pn')'t * t'x = (1/h²) * (Δ²yₙ₋₂ + (t+1)Δ³yₙ₋₃ + ...).

Відмітимо, що за х₀ чи хₙ можна прийняти будь–який проміжний вузол таблиці, тому зазвичай вибирають ближчий до х табличне значення аргументу.

Формули чисельного диференціювання значно спрощуються, якщо похідна відшуковується у вузлі інтерполяції, наприклад в точці xₖ. Прийнявши тоді xₖ за х₀, одержимо t=0, а із формул одержуємо:

Pn'(x₀) = (1/h) * (Δy₀ - (Δ²y₀/2!) + (Δ³y₀/3!) - ... + (-1)ⁿ⁻¹(Δⁿy₀/n)),

Pn"(x) = (1/h²) * (Δ²y₀ - Δ³y₀ + ...).

#### 3. Графічне диференціювання

Суть графічного диференціювання полягає в тому, щоб по графіку функції, заданому на деякому відрізку [a;b], будується приблизно графік її похідної. Ця побудова основана на геометричному змісті похідної і по формулі Лагранжа скінчених приростів.

Нехай на малому відрізку [x₀;x₀+Δx] заданий графік функції y=f(x). Із формули скінчених приростів слідує, що

f'(ξ) = (f(x₀+Δx) - f(x₀))/Δx,

де x₀<ξ<x₀+Δx. Геометрично вираз, що стоїть справа, це тангенс кута нахилу хорди АВ, а розміщений зліва кутовий коефіцієнт дотичної до цієї точки ξ (x₀;x₀+Δx). Якщо Δx мале, то в якості ξ можна взяти точку, що лежить посередині [x₀;x₀+Δx], тобто ξ=x₀+Δx/2, тоді одержуємо наближену рівність:

f'(x₀+Δx/2) ≈ (f(x₀+Δx) - f(x₀))/Δx.

Для відшукання похідної в точці x₀+Δx/2 треба знайти тангенс кута нахилу хорди АВ. Для цього проведемо слідуючи побудови. Від точки О (або від любої другої точки зовні відрізка [x₀;x₀+Δx]) вліво відкладемо одиничний відрізок ОК і проведемо KD||AB. Величина відрізка OD=OK*tgφ, де φ=<DKO=<BAC. Відповідно, OD=f'(x₀+Δx/2). Проведемо DN паралельно осі ox. Тоді точка N, що відповідає абсцисі x₀+Δx/2, буде мати ординатою f'(x₀+Δx/2), тобто це точка графіка похідної функції f(x).

![Рисунок 1](https://claude.ai/chat/d9b0f1ec-0298-4a3d-a71c-bcdbe9efcd1e)

Нехай тепер функція f(x) задана на відрізку [a;b]. Відрізок [a;b] розіб'ємо на n частинних відрізки, не обов'язково рівних між собою, але так, щоб на кожному із них функція вела себе монотонно. На кожному частинному відрізку проведемо побудови, аналогічні описаним вище для відрізка [x₀;x₀+Δx]. В кінці побудовані точки, аналогічні точці N, з'єднуємо ламаною, яка приблизно представляє графік похідної заданої функції f(x).

**Приклад.** Функція задана графічно на відрізка [0;b] кривою А₀А₁...А₆ (рис. 2). Побудувати графік її похідної.

**Розв'язання**

Розіб'ємо відрізок [0; b] на 6 частин точками х₀=0, х₁, х₂, х₃, x₄, х₅, х₆ = b, як зазначено на мал. 2, і вліво від точки О відкладемо відрізок ОК=1.

Розглядаємо перший відрізок [0; х₁] і проводимо хорду А₀А₁. Потім із точки K проводимо пряму KD₁ || A₀A₁ до перетину в точці D₁ з віссю Оу. З D₁ проводимо пряму D₁N₁, паралельну осі Ох, до перетинання в точці N₁ із прямої, паралельною осі Оу і проведеної із середини відрізка [0; х₁]. Розглядаємо відрізок [х₁; х₂]. Будуємо хорду А₁А₂ і пряму KD₂, паралельну хорді. Далі проводимо D₂N₂ || Ох і відмічаємо точку N₂, що відповідає середині відрізка [х₁; х₂]. Проводимо аналогічні побудови на відрізках [х₂; х₃], [х₃; х₄], [x₄; x₅], [х₅; х₆]. Одержуємо точки N₃, ..., N₆.

З'єднуємо точки N₁, N₂, N₃, N₄, N₅, N₆ ламаної (див. рис. 2), що приблизно дають собою уявлення про графік похідної заданої функції.

![Рисунок 2](https://claude.ai/chat/d9b0f1ec-0298-4a3d-a71c-bcdbe9efcd1e)

### Завдання:

1. Програмно реалізувати метод наближеного диференціювання за допомогою інтерполяційного многочлена Ньютона для знаходження першої і другої похідних при даних значеннях аргументу для функції, заданої таблично.
    
2. Знайти першу і другу похідні при даних значеннях аргументу для функції, заданої таблично методом графічного диференціювання.
    

#### Таблиця №1 для варіантів n=1,3,5,7,…,29 :

|x|y(x)|x|y(x)|
|---|---|---|---|
|2,4|3,526|3,6|4,222|
|2,6|3,782|3,8|4,331|
|2,8|3,945|4,0|4,507|
|3,0|4,043|4,2|4,775|
|3,2|4,104|4,4|5,159|
|3,4|4,155|4,6|5,683|

а) х=2,4+0,05n; б) х=3,12+0,03n; в) x=4,5-0,06n; г) х=4,04-0,04n (n=1,3,5,7,…,29), n – номер варіанту

#### Таблиця №2 для варіантів n=2,4,6,8,...,30:

|x|y(x)|x|y(x)|
|---|---|---|---|
|1,5|10,517|4,5|8,442|
|2,0|10,193|5,0|8,482|
|2,5|9,807|5,5|8,862|
|3,0|9,387|6,0|9,701|
|3,5|8,977|6,5|11,132|
|4,0|8,637|7,0|13,302|

а) х=1,6+0,08n; б) х=3,27+0,11n; в) x=6,3-0,12n; г) х=5,85-0,09n (n=2,4,6,8,...,30), n – номер варіанту